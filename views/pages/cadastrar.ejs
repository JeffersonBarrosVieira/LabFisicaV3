<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta http-equiv="content-language" content="pt-br, en-US" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Jefferson Barros Vieira">
    <meta name="reply-to" content="[jefferson.negociom03@gmail.com]">
    <meta name="description" content="LabFísica - Ambiente virtual para estudantes e professores da área da Física. Resolva problemas físicos, visualize simulações, interaja com elas e realize uma análise da modelagem matemática completa.">

    <meta name="keywords" content="labf&iacute;sica, plataforma, ferramenta, metodo, aluno, alunos, professor, professores, estudante, estudantes, medio, m&eacute;dio, fundamental, imagina&ccedil;&atilde;o, criatividade, interacao, intera&ccedil;&atilde;o, intera&ccedil;&otilde;es, interativo, interativa, alternativa, ambiente, LabF&iacute;sica, laboratorio, laborat&oacute;rio, fisica, f&iacute;sica, virtual, simulacao, simula&ccedil;&atilde;o, desenvolvimento, experimentos, experi&ecirc;ncias, experi&ecirc;cia, ensino, resolu&ccedil;&atilde;o, resolucao, problemas, modelagem, matematica, matem&aacute;tica, mecanica, mec&acirc;nica, classica, cl&aacute;ssica, ondas, oscila&ccedil;&otilde;es, oscilacoes, termodinamica, termodin&acirc;mica, optica, otica, &oacute;ptica, &oacute;tica, geometrica, cinematica, cinem&aacute;tica, dinamica, din&acirc;mica, leis, newton, trabalho, energia, potencia, pot&ecirc;ncia, momento, gravitacao, gravita&ccedil;&atilde;o, hidrostatica, hideost&aacute;tica, hidrodinamica, hidrodin&acirc;mica pendulo, propagacao, propaga&ccedil;&atilde;o, reflex&atilde;o, reflexao, refraç&ccedil;&atilde;o, refracao, difracao, difra&ccedil;&atilde;o, interferencia, interfer&ecirc;ncia, termometria, escalas, dioptros, di&oacute;ptro, lentes, dilatacao, dilata&ccedil;&atilde;o, calor, vetor, vetorial, escalar, movimento, distancia, dist&acirc;ncia, trajet&oacute;ria, repouso, avi&acirc;o, referencial, deslocamento, c&aacute;lculo" />


    <meta name="google-site-verification" content="92FSmC8Iy0ILzcHYQP4W1rqplh1qALjqglWEHauiJVk" />
    <meta name="copyright" content="© 2021 Jefferson Barros Vieira" />

    <meta http-equiv="cache-control" content="public" />
    <meta name="revisit-after" content="7 days" /> 

    <meta name="generator" content="Visual Studio Code" />

    <link rel="canonical" href="https://www.labfisica.com/cadastrar" />
    <link rel="shortcut icon" type="image/x-icon" href="/img/icon.png" />
    <link rel="preload" as="image" href="/img/loader.gif" />

    <title>LabFísica - Cadastro</title>
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>
<body>

    <%# Preload %>
    <%- include('../components/templates/Preload', {preload__name: 'Carregando...'}) %> 

    <div class="fundo">
        <canvas id="wallpaper"></canvas>
    </div>

    <main class="main entrar-content">
        
        <form action="/cadastrar" method="POST" id="formulario" onsubmit="return verificar()">

            <a href="/"><div class="voltar"></div></a>
            
            <a href="/">
                <h1>LabFísica</h1>
            </a>
            
            <% if (tentativa) { %>
                <li style="color: rgba(255, 0, 0, 0.9); font-size: 0.9rem;" >
                    <%= sucesso ? 'Insira seu Email' : 'Email já está cadastrado' %> 
                </li>
            <% } %>
            <input id="email" name="email" type="email" placeholder="Email" style="text-transform: lowercase;">


            <div class="g-recaptcha" data-sitekey="6LefqzscAAAAADs5E587dRKaz8DZ53lhfqfLMQt0" data-callback="verifyCaptcha"></div>
            <div id="g-recaptcha-error"></div>
            <input class="btn-formulario" type="submit" value="Cadastrar"/>
            <label style="  
                            width: 100%;
                            margin-bottom: 10px;
                            text-align: center;
                            font-size: 1.1rem;
                        ">ou</label>
            <div style="
                        width: 100%;
                        justify-content: center;
                        display: flex;">

                <div id="btnLogar"
                    class="customGPlusSignIn"
                    style="
                            display: inline-block;
                            background: #4285f4;
                            color: white;
                            width: 220px;
                            border-radius: 5px;
                            white-space: nowrap;
                            cursor: pointer;
                        ">
                    <span   style="
                                    background: url('https://www.shareicon.net/data/256x256/2015/10/04/111650_google-icon_512x512.png') transparent 5px 50% no-repeat;
                                    background-size: 38px 38px;
                                    display: inline-block;
                                    vertical-align: middle;
                                    width: 42px;
                                    height: 45px;"> </span>
                    <span   style="
                                    display: inline-block;
                                    vertical-align: middle;
                                    padding-left: 10px;
                                    font-size: 14px;
                                    font-weight: bold;
                                    font-family: 'Roboto', sans-serif;
                                "> Entrar com o Google </span>
                </div>
            </div>
        </form>

    </main>

    <script src="/js/fundo.js"></script>
    <script src="https://www.google.com/recaptcha/api.js"></script>
    <%# Google api %>
    <script src="https://apis.google.com/js/api:client.js"></script>

    <script>
        function verificar(){

            if (document.getElementById('email').value == ''){
                alert("Insira seu Email");
                return false
            }

            return submitForm();
        }

        function submitForm() {
            let response = grecaptcha.getResponse();
            
            if(response.length == 0) {
                document.getElementById('g-recaptcha-error').innerHTML = `
                <span style="color: rgba(255, 0, 0, 0.9); font-size: 0.9rem;">
                    É necessário a verificação!
                    </span>
                `;
                return false;
            }
            return true;
        }
        
        function verifyCaptcha() {
            document.getElementById('g-recaptcha-error').innerHTML = '';
        }
    </script>
    
    
    <script>

        // Google Api

        var startApp = function() {
            gapi.load('auth2', function(){
                auth2 = gapi.auth2.init({
                client_id: `680773311170-8538oubn1svoaru3qhblpkqmmqmpi1ni.apps.googleusercontent.com`,
                cookiepolicy: 'single_host_origin',
                scope: 'profile email' // solicitando acesso ao profile e ao e-mail do usuário
                });
                auth2.attachClickHandler(document.getElementById('btnLogar'), {}, onSuccess, onFailure);
            });
        };

         /**
         Função executada quando o login é efetuado com sucesso
        */
        function onSuccess(googleUser) {
            // Recuperando o profile do usuário
            var profile = googleUser.getBasicProfile();
            console.log("ID: " + profile.getId()); // Don't send this directly to your server!
            console.log("Name: " + profile.getName());
            console.log("Image URL: " + profile.getImageUrl());
            console.log("Email: " + profile.getEmail());

            let xhr = new XMLHttpRequest();
            xhr.open('POST', '/cadastrar', true);
            xhr.setRequestHeader('Content-Type', 'application/json');
            xhr.send(JSON.stringify({
                google: true,
                nome: `${profile.getName()}`,
                imageUrl: `${profile.getImageUrl()}`,
                email: `${profile.getEmail()}`,
                
            }));

            // Recuperando o token do usuario. Essa informação você necessita passar para seu backend
            // var id_token = googleUser.getAuthResponse().id_token;
            // console.log("ID Token: " + id_token);
        }
        /**
         Função executada quando ocorrer falha no logn
        */
        function onFailure(error) {
            console.log(error);
        }

        /**
         Função de deslogar o usuario
        */
        function signOut() {
            var auth2 = gapi.auth2.getAuthInstance();
            auth2.signOut().then(function () {
                console.log('User signed out.');
            });
        }

        startApp();
    </script>
</body>
</html>